{% extends "orders/base.html" %}
{% block title %}Ø³Ø¬Ù„ Ø§Ù„Ù…Ø®Ø²ÙˆÙ†{% endblock %}

{% block content %}
<div class="container mt-4">

  <div class="d-flex justify-content-between align-items-center mb-3">
    <h1>ğŸ“¦ Ø³Ø¬Ù„ Ø¹Ù…Ù„ÙŠØ§Øª Ø§Ù„Ù…Ø®Ø²ÙˆÙ† {% if branch %}- {{ branch.name }}{% endif %}</h1>
    <a href="{% url 'home' %}" class="btn btn-primary">â¬… Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ù…Ù†ØªØ¬Ø§Øª</a>
  </div>

  <!-- ğŸ”½ ÙÙ„ØªØ±Ø© Ø§Ù„ØªØ§Ø±ÙŠØ® + Ø§Ù„Ø¨Ø­Ø« -->
  <form method="get" class="mb-3">
    <div class="row g-3 align-items-end">
      <div class="col-md-3">
        <label class="form-label">Ù…Ù†:</label>
        <input type="date" class="form-control" name="start_date" value="{{ start_date|default:'' }}">
      </div>
      <div class="col-md-3">
        <label class="form-label">Ø¥Ù„Ù‰:</label>
        <input type="date" class="form-control" name="end_date" value="{{ end_date|default:'' }}">
      </div>

      {% if branches %}
      <div class="col-md-3">
        <label class="form-label">Ø§Ù„ÙØ±Ø¹:</label>
        <select name="branch" class="form-select" onchange="this.form.submit()">
          <option value="all" {% if not selected_branch %}selected{% endif %}>-- ÙƒÙ„ Ø§Ù„ÙØ±ÙˆØ¹ --</option>
          {% for b in branches %}
            <option value="{{ b.id }}" {% if selected_branch == b.id %}selected{% endif %}>
              {{ b.name }}
            </option>
          {% endfor %}
        </select>
      </div>
      {% endif %}

      <div class="col-md-3">
        <label class="form-label">Ø¨Ø­Ø«:</label>
        <input type="text" class="form-control" name="q" value="{{ query|default:'' }}" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ù†ØªØ¬">
      </div>

      <div class="col-md-12">
        <button type="submit" class="btn btn-success">Ø¹Ø±Ø¶</button>
      </div>
    </div>
  </form>

  <!-- âœ… Ø¬Ø¯ÙˆÙ„ Ù…Ù†Ø³Ù‚ -->
  <div class="table-responsive">
    <table class="table table-bordered table-striped text-center">
      <thead class="table-dark">
        <tr>
          <th>Ø§Ù„ØªØ§Ø±ÙŠØ®</th>
          <th>Ø§Ù„Ù…Ù†ØªØ¬</th>
          <th>Ø§Ù„ÙƒÙ…ÙŠØ©</th>
          <th>Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</th>
        </tr>
      </thead>
      <tbody>
        {% for tx in transactions %}
        <tr>
          <td>{{ tx.created_at|date:"Y-m-d H:i" }}</td>
          <td>{{ tx.product.name }}</td>
          <td>{{ tx.quantity }}</td>
          <td>{% if tx.added_by %}{{ tx.added_by.username }}{% else %}ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ{% endif %}</td>
        </tr>
        {% empty %}
        <tr><td colspan="4" class="text-center">ğŸš« Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø¹Ù…Ù„ÙŠØ§Øª Ø¨Ø¹Ø¯</td></tr>
        {% endfor %}
      </tbody>
    </table>
  </div>

</div>
{% endblock %}
