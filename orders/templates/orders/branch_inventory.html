{% extends "orders/base.html" %}
{% block title %}ğŸ“¦ Ø§Ù„Ù…Ø®Ø²ÙˆÙ†{% endblock %}

{% block content %}
<h2>
  ğŸ“¦ Ø§Ù„Ù…Ø®Ø²ÙˆÙ†
  {% if branch %}
    - {{ branch.name }}
  {% elif branches %}
    - ÙƒÙ„ Ø§Ù„ÙØ±ÙˆØ¹
  {% endif %}
</h2>

<!-- ğŸ”½ ÙÙ„ØªØ±Ø© Ø§Ù„Ø£Ù‚Ø³Ø§Ù… + Ø§Ù„Ø¨Ø­Ø« + Ø§Ù„ÙØ±ÙˆØ¹ -->
<form method="get" class="mb-3" id="filterForm">
  <div class="d-flex flex-wrap gap-3 align-items-end">

    {% if branches %}
    <div class="form-group">
      <label class="form-label">Ø§Ù„ÙØ±Ø¹:</label>
      <select name="branch" class="form-select" onchange="this.form.submit()">
        <option value="all" {% if not selected_branch %}selected{% endif %}>-- ÙƒÙ„ Ø§Ù„ÙØ±ÙˆØ¹ --</option>
        {% for b in branches %}
          <option value="{{ b.id }}" {% if selected_branch == b.id %}selected{% endif %}>
            {{ b.name }}
          </option>
        {% endfor %}
      </select>
    </div>
    {% endif %}

    <div class="form-group">
      <label class="form-label">Ø§Ù„Ù‚Ø³Ù…:</label>
      <select name="category" class="form-select" onchange="this.form.submit()">
        <option value="">-- ÙƒÙ„ Ø§Ù„Ø£Ù‚Ø³Ø§Ù… --</option>
        {% for c in categories %}
          <option value="{{ c.id }}" {% if selected_category == c.id %}selected{% endif %}>
            {{ c.name }}
          </option>
        {% endfor %}
      </select>
    </div>

    <div class="form-group">
      <label class="form-label">Ø¨Ø­Ø«:</label>
      <input type="text" class="form-control" name="q" value="{{ query|default:'' }}" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ù†ØªØ¬">
    </div>

    <div>
      <button type="submit" class="btn btn-primary">Ø¹Ø±Ø¶</button>
    </div>
  </div>
</form>

<!-- Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…Ø®Ø²ÙˆÙ† -->
<div class="table-responsive mt-4">
  <table class="table table-bordered table-striped table-hover text-center align-middle">
    <thead class="table-dark">
      <tr>
        <th style="width:40%;">Ø§Ù„Ù…Ù†ØªØ¬</th>
        <th style="width:20%;">Ø§Ù„Ù‚Ø³Ù…</th>
        {% if branches %}<th style="width:20%;">Ø§Ù„ÙØ±Ø¹</th>{% endif %}
        <th style="width:20%;">Ø§Ù„ÙƒÙ…ÙŠØ© Ø§Ù„Ù…ØªÙˆÙØ±Ø©</th>
      </tr>
    </thead>
    <tbody>
      {% for inv in inventories %}
      <tr>
        <td class="text-start">{{ inv.product.name }}</td>
        <td>{{ inv.product.category.name }}</td>
        {% if branches %}<td>{{ inv.branch.name }}</td>{% endif %}
        <td>{{ inv.quantity }}</td>
      </tr>
      {% empty %}
      <tr>
        <td colspan="{% if branches %}4{% else %}3{% endif %}" class="text-center">âŒ Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù†ØªØ¬Ø§Øª Ù…Ø·Ø§Ø¨Ù‚Ø©.</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>

<!-- âœ… Hover Effect -->
<style>
  .table.table-hover tbody tr:hover > td {
      background-color: #f8d7da !important; /* Ø£Ø­Ù…Ø± ÙØ§ØªØ­ */
      color: #000 !important;              /* Ø§Ù„Ù†Øµ ÙŠÙØ¶Ù„ ÙˆØ§Ø¶Ø­ */
      transition: background 0.2s ease;
  }


</style>

<script>
  document.querySelector("input[name='q']").addEventListener("keypress", function(e) {
    if (e.key === "Enter") {
      e.preventDefault();
      document.getElementById("filterForm").submit();
    }
  });
</script>
{% endblock %}
