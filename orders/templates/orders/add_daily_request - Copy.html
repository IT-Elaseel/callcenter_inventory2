<h2>ğŸ“ Ø§Ù„Ø·Ù„Ø¨ Ø§Ù„ÙŠÙˆÙ…ÙŠ</h2>
<form method="post">
  {% csrf_token %}

  <!-- Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù…Ù†ØªØ¬ -->
  <select name="product" id="productSelect" required onchange="updateUnitLabel()">
    <option value="">-- Ø§Ø®ØªØ± Ø§Ù„Ù…Ù†ØªØ¬ --</option>
    {% for p in products %}
      <option value="{{ p.id }}" data-unit="{{ p.get_unit_display }}">{{ p.name }}</option>
    {% endfor %}
  </select>

  <!-- Ø§Ù„ÙƒÙ…ÙŠØ© + Ø§Ù„ÙˆØ­Ø¯Ø© Ø¬Ù†Ø¨Ù‡Ø§ -->
  <div style="display:inline-flex; align-items:center; gap:6px; margin-top:5px;">
    <input type="number" name="quantity" min="1" required placeholder="Ø§Ù„ÙƒÙ…ÙŠØ©">
    <span id="unitLabel" style="font-weight:bold; color:#333; display:none;"></span>
  </div>

  <!-- Ø²Ø±Ø§Ø± Ø§Ù„Ø¥Ø¶Ø§ÙØ© -->
  <button type="submit" name="add_item" class="btn btn-success">â• Ø¥Ø¶Ø§ÙØ©</button>
</form>

<h3>Ø§Ù„Ø·Ù„Ø¨ÙŠØ© Ø§Ù„Ø­Ø§Ù„ÙŠØ© (Ø±Ù‚Ù…: {{ order_number }})</h3>
<table class="table">
  <tr>
    <th>Ø§Ù„Ù…Ù†ØªØ¬</th>
    <th>Ø§Ù„ÙƒÙ…ÙŠØ©</th>
    <th>Ø§Ù„ÙˆØ­Ø¯Ø©</th>
    <th>Ø§Ù„ÙˆÙ‚Øª</th>
  </tr>
  {% for r in requests_today %}
    <tr>
      <td>{{ r.product.name }}</td>
      <td>{{ r.quantity }}</td>
      <td>{{ r.product.get_unit_display }}</td>
      <td>{{ r.created_at|date:"H:i:s" }}</td>
    </tr>
  {% empty %}
    <tr><td colspan="3">ğŸš« Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ù†ØªØ¬Ø§Øª</td></tr>
  {% endfor %}
</table>

{% if requests_today %}
  <form method="post">
    {% csrf_token %}
    <button type="submit" name="confirm_order" class="btn btn-primary">âœ… ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø·Ù„Ø¨ÙŠØ©</button>
  </form>
{% endif %}
<script>
function updateUnitLabel() {
  const select = document.getElementById("productSelect");
  const unitLabel = document.getElementById("unitLabel");
  const selectedOption = select.options[select.selectedIndex];
  const unit = selectedOption.getAttribute("data-unit");

  if (unit) {
    unitLabel.textContent = unit;
    unitLabel.style.display = "inline"; // ÙŠØ¸Ù‡Ø± Ø¨Ø³ Ø¹Ù†Ø¯ Ø§Ø®ØªÙŠØ§Ø± Ù…Ù†ØªØ¬
  } else {
    unitLabel.textContent = "";
    unitLabel.style.display = "none"; // ÙŠØ®ØªÙÙŠ Ù„Ùˆ Ù…Ø§ Ø§Ø®ØªØ±ØªØ´ Ù…Ù†ØªØ¬
  }
}
</script>
